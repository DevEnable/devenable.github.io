
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Proof of Concept Data - Stephen Kennedy</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Proof of Concept Data">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Proof of Concept Data">
    <meta property="og:description" content="">

    <link href="../favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="http://localhost:2368/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link rel="stylesheet" type="text/css" href="../assets/css/uno.css?v=86ac6b006d">

    <link rel="canonical" href="http://www.devenable.com/proof-of-concept-data/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://www.devenable.com/proof-of-concept-data/amp/">
    
    <meta property="og:site_name" content="Stephen Kennedy">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Proof of Concept Data">
    <meta property="og:description" content="This blog post details the data structures for the cross mobile proof of concept application that I am doing a blog series on. Entities For my proof of concept I have a very simple table with the following entity declaration:   public class InternetLocation : EntityData   {     public string Title { get; set; }     public">
    <meta property="og:url" content="http://www.devenable.com/proof-of-concept-data/">
    <meta property="article:published_time" content="2014-04-12T04:54:37.000Z">
    <meta property="article:modified_time" content="2014-04-12T05:12:55.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Proof of Concept Data">
    <meta name="twitter:description" content="This blog post details the data structures for the cross mobile proof of concept application that I am doing a blog series on. Entities For my proof of concept I have a very simple table with the following entity declaration:   public class InternetLocation : EntityData   {     public string Title { get; set; }     public">
    <meta name="twitter:url" content="http://www.devenable.com/proof-of-concept-data/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Stephen Kennedy">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Stephen Kennedy",
        "logo": "http://www.devenable.com/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Stephen Kennedy",
        "url": "http://www.devenable.com/author/stephen-kennedy/",
        "sameAs": []
    },
    "headline": "Proof of Concept Data",
    "url": "http://www.devenable.com/proof-of-concept-data/",
    "datePublished": "2014-04-12T04:54:37.000Z",
    "dateModified": "2014-04-12T05:12:55.000Z",
    "description": "This blog post details the data structures for the cross mobile proof of concept application that I am doing a blog series on. Entities For my proof of concept I have a very simple table with the following entity declaration:   public class InternetLocation : EntityData   {     public string Title { get; set; }     public",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.devenable.com"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Stephen Kennedy" href="http://www.devenable.com/rss/">

</head>
<body class="post-template no-js">

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    <header class="panel-cover panel-cover--collapsed ">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <h1 class="panel-cover__title panel-title"><a href="http://www.devenable.com" title="link to homepage for Stephen Kennedy">Stephen Kennedy</a></h1>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software engineer in the Microsoft technology stack, focusing on native and high-scale systems development.  Works for Readify.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="../index.html#blog" title="link to Stephen Kennedy blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          
<nav class="cover-navigation navigation--social">
  <ul class="navigation">


  <!-- Twitter -->
  <li class="navigation__item">
    <a href="http://twitter.com/daleanthony" title="@DaleAnthony on Twitter">
      <i class="icon icon-social-twitter"></i>
      <span class="label">Twitter</span>
    </a>
  </li>

    <!-- Dribbble -->
    <li class="navigation__item">
      <a href="http://dribbble.com/daleanthony" title="Dale-Anthony on Dribbble">
        <i class="icon icon-social-dribbble"></i>
        <span class="label">Dribbble</span>
      </a>
    </li>

    <!-- Email -->
    <li class="navigation__item">
      <a href="mailto:hello@daleanthony.com" title="Email hello@daleanthony.com">
        <i class="icon icon-mail"></i>
        <span class="label">Email</span>
      </a>
    </li>

    <!-- RSS -->
    <li class="navigation__item">
      <a href="../rss/index.rss" title="Subscribe">
        <i class="icon icon-rss"></i>
        <span class="label">RSS</span>
      </a>
    </li>

  </ul>
</nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>
    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            

  <article class="post-container post-container--single">

    <header class="post-header">
      <div class="post-meta">
        <time datetime="12 Apr 2014" class="post-meta__date date">12 Apr 2014</time> • <span class="post-meta__tags tags"></span>
        <!--<span class="post-meta__author author"><img src="" alt="profile image for Stephen Kennedy" class="avatar post-meta__avatar" /> by Stephen Kennedy</span>-->
      </div>
      <h1 class="post-title">Proof of Concept Data</h1>
    </header>

    <section class="post">
      <p class="intro">This blog post details the data structures for the cross mobile <a href="../xamarin-android-with-azure-mobile-services-net-blog-series/">proof of concept</a> application that I am doing a blog series on.</p>

<hr>

<h2 id="entities">Entities</h2>

<p>For my proof of concept I have a very simple table with the following entity declaration:  </p>

<pre><code class="language-prettyprint lang-cs">public class InternetLocation : EntityData  
{
    public string Title { get; set; }

    public DbGeography Location { get ; set ; }

    public string Address { get; set; }

    public int PostCode { get; set; }

    public bool HasWifi { get; set; }

    public string OtherFacilities { get; set; }
}
</code></pre>

<p>EntityData is a Mobile Services class that has a string Id column as well as versioning, deletion flags, and update / creation fields.  Your entities do <em>not</em> have to inherit from this class, but it can make life easier, particularly if you want to use the MappedEntityDomainManager class (described below).</p>

<p>The default the mode for Entity Framework is code first in Azure Mobile Services and as such the database schema will follow the structure that you define (ModelBuilder configuration and conventions included).</p>

<hr>

<h2 id="dataschemainitialization">Data Schema &amp; Initialization</h2>

<p>As I have detailed <a href="../azure-mobile-services-creation-and-configuration/">previously</a> the initialization logic for the database is called from the WebApiConfig class.  </p>

<pre><code class="language-prettyprint lang-cs">Database.SetInitializer(new DataVicInitializer ());  
</code></pre>

<p>Is the code which tells EF to initialize the database if required.  </p>

<pre><code class="language-prettyprint lang-cs">public class DataVicInitializer : DropCreateDatabaseIfModelChanges &lt;DataVicContext &gt;  
{

}
</code></pre>

<p>DataVicInitializer inherits from the standard DropCreateDatabaseIfModelChanges abstract class that Entity Framework provides.  This is all pretty standard fare and you can find plenty of documentation online about this class and Entity Framework Code First initialization.</p>

<p>The DataVicContext is exactly the same DataContext that Azure Mobile Services provides except that the TodoItems DbSet has been replaced with an InternetLocations property instead.</p>

<p>And that is all you need to initialize your database for use by your controllers and scheduled jobs. </p>

<hr>

<h2 id="dtos">DTO's</h2>

<p>The corresponding exposed DTO has the following structure:  </p>

<pre><code class="language-prettyprint lang-cs">[JsonObject(Title = "InternetLocation", MemberSerialization = MemberSerialization.OptIn)]
public class InternetLocationModel : ITableData  
{
    public string Id { get; set; }

    public byte[] Version { get; set; }
    public DateTimeOffset? CreatedAt { get ; set ; }
    public DateTimeOffset? UpdatedAt { get ; set ; }
    public bool Deleted { get; set; }

    [JsonProperty]
    public string Title { get; set; }

    [JsonProperty]
    public MapLocation Location { get ; set ; }

    [JsonProperty]
    public string Address { get; set; }

    [JsonProperty]
    public bool HasWifi { get; set; }

    [JsonProperty]
    public string OtherFacilities { get; set; }
}

[JsonObject(MemberSerialization = MemberSerialization.OptIn)]
public class MapLocation  
{
    [JsonProperty]
    public double Longitude { get; set; }

    [JsonProperty]
    public double Latitude { get; set; }
}
</code></pre>

<p>I'm not going to be sending any of the ITableData members to my clients as for my purposes they do not need any of this information.</p>

<hr>

<h2 id="whynottablestorage">Why Not Table Storage?</h2>

<p>Given that I just have a flat structure, why wouldn't I just use table storage?  There are two reasons for this.  </p>

<p>The first reason is because it is easier to just use SQL Azure as this is what the template and all of the samples give, however, looking at the contracts and implementation of TableController it could be quite possible in theory to use Azure Table Storage as your backend data source.  </p>

<p>The second, and bigger reason, however, is because I am using the DbGeography data type and I want to leverage the inbuilt spatial functionality that SQL Azure offers, whereas, table storage does not support this present.</p>
    </section>

  </article>




            <footer class="footer">
    <span class="footer__copyright">© 2016. All rights reserved.</span>
    <span class="footer__copyright"><a href="http://uno.daleanthony.com" title="link to page for Uno Ghost theme">Uno theme</a> by <a href="http://daleanthony.com" title="link to website for Dale-Anthony">Dale-Anthony</a></span>
    <span class="footer__copyright">Proudly published with <a href="http://ghost.org" title="link to Ghost website">Ghost</a></span>
</footer>        </div>
    </div>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script type="text/javascript" src="../assets/js/main.js?v=86ac6b006d"></script>
	<script type="text/javascript" src="http://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
</body>
